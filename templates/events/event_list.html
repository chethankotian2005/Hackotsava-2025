{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="events-page">
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">All Events</h1>
            <p class="page-subtitle">Browse through Hackotsava event galleries</p>
        </div>
        
        <!-- Search Bar -->
        <div class="search-section">
            <form method="get" class="search-form">
                <div class="search-input-group">
                    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="m21 21-4.35-4.35"/>
                    </svg>
                    <input type="text" name="search" placeholder="Search events..." value="{{ search_query }}" class="search-input">
                    <button type="submit" class="btn btn-primary">Search</button>
                </div>
            </form>
        </div>
        
        <!-- Events Grid -->
        {% if events %}
        <div class="events-grid">
            {% for event in events %}
            <div class="event-card" data-aos="fade-up">
                <div class="event-image">
                    {% if event.cover_image %}
                    <img src="{{ event.cover_image.url }}" alt="{{ event.name }}" loading="lazy">
                    {% else %}
                    <div class="event-placeholder">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                            <circle cx="8.5" cy="8.5" r="1.5"/>
                            <polyline points="21 15 16 10 5 21"/>
                        </svg>
                    </div>
                    {% endif %}
                    <div class="event-badge">{{ event.photo_count }} Photos</div>
                </div>
                
                <div class="event-content">
                    <h3 class="event-title">{{ event.name }}</h3>
                    
                    <div class="event-meta">
                        <span class="event-date">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
                            </svg>
                            {{ event.event_date|date:"M d, Y" }}
                        </span>
                        
                        {% if event.location %}
                        <span class="event-location">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/>
                            </svg>
                            {{ event.location|truncatewords:3 }}
                        </span>
                        {% endif %}
                    </div>
                    
                    <p class="event-description">{{ event.description|truncatewords:15 }}</p>
                    
                    <div class="event-actions">
                        <a href="{% url 'event_detail' event.slug %}" class="btn btn-primary btn-sm">View Event</a>
                        <a href="{% url 'search_faces' event.slug %}" class="btn btn-outline btn-sm">Search Photos</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if events.has_other_pages %}
        <div class="pagination">
            {% if events.has_previous %}
            <a href="?page={{ events.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" class="page-link">&laquo; Previous</a>
            {% endif %}
            
            <span class="page-info">Page {{ events.number }} of {{ events.paginator.num_pages }}</span>
            
            {% if events.has_next %}
            <a href="?page={{ events.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}" class="page-link">Next &raquo;</a>
            {% endif %}
        </div>
        {% endif %}
        
        {% else %}
        <div class="empty-state">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <path d="m21 21-4.35-4.35"/>
            </svg>
            <h3>No events found</h3>
            <p>{% if search_query %}Try a different search term{% else %}No events available at the moment{% endif %}</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
